/**
 * 内爆过渡模式（从外向内收缩）
 * v2.0 - 优化默认 radius 确保完全覆盖；OLD 视图做收缩动画
 */

:root[data-transition='implosion'] {
  &::view-transition-group(root) {
    animation-duration: var(--theme-transition-duration, 0.4s);
    animation-timing-function: cubic-bezier(0.25, 0, 0.25, 1);
  }

  // 内爆：OLD 在上面收缩，露出下面的 NEW
  &::view-transition-new(root) {
    z-index: 1; // NEW 在下面
    animation: none;
    animation-fill-mode: forwards;
    mix-blend-mode: normal;
  }

  &::view-transition-old(root) {
    z-index: 9999; // OLD 在上面，收缩后露出 NEW
    clip-path: circle(
      var(--transition-radius, 150%) at var(--transition-x, 50%) var(--transition-y, 50%)
    );
    animation: implosion-collapse var(--theme-transition-duration, 0.4s)
      cubic-bezier(0.25, 0, 0.25, 1) forwards;
  }
}

@keyframes implosion-collapse {
  0% {
    clip-path: circle(
      var(--transition-radius, 150%) at var(--transition-x, 50%) var(--transition-y, 50%)
    );
  }
  100% {
    clip-path: circle(0px at var(--transition-x, 50%) var(--transition-y, 50%));
  }
}
